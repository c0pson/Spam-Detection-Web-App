<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Spam Detector</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script>
        (function() {
            const savedTheme = localStorage.getItem('theme');
            const savedFont = localStorage.getItem('fontSize');
            if (savedTheme === 'dark') {
                document.documentElement.classList.add('theme-dark');
            } else {
                document.documentElement.classList.add('theme-light');
            }
            if (savedFont) {
                document.documentElement.classList.add('font-' + savedFont);
            } else {
                document.documentElement.classList.add('font-medium');
            }
        })();
    </script>
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link rel="stylesheet" href="{{ url_for('spam.static', filename='css/styles.css') }}">
</head>
<body>
<header class="app-header">
    <div class="header-inner">
        <div class="header-left">
            <div class="logo-circle"></div>
            <span class="header-title">
                Spam Detector
            </span>
        </div>
        <div class="header-right">
            <button
                    id="fontToggleBtn"
                    class="icon-button font-toggle-btn"
                    type="button"
                    aria-label="Change font size"
                    onclick="toggleFont()"
            >
                <span class="font-toggle-symbol">
                    <span class="font-toggle-small">aA</span>
                    <span class="font-toggle-large">A</span>
                </span>
            </button>
            <button
                    id="themeToggleBtn"
                    class="icon-button theme-toggle-btn"
                    type="button"
                    aria-pressed="false"
                    aria-label="Toggle dark mode"
                    onclick="toggleTheme()"
            >
                <span class="icon-sun material-icons">light_mode</span>
                <span class="icon-moon material-icons">dark_mode</span>
            </button>
        </div>
    </div>
</header>
<main class="page-content">
    <section id="screen-initial" class="hero-section" {% if show_result %}style="display: none;"{% endif %}>
        <div class="hero-inner">
            <h1 class="hero-title">
                Detect if your email is spam or not
            </h1>
            <form method="POST" action="{{ url_for('spam.show_form') }}" class="hero-input-area">
                <textarea
                        name="email_body"
                        id="email_body"
                        class="email-textarea"
                        placeholder="Enter your email content here..."
                        rows="4"
                        required
                ></textarea>
                <div style="display: flex; align-items: center; gap: 10px; margin-top: 10px;">
                    <label style="display: flex; align-items: center; gap: 5px; cursor: pointer;">
                        <input
                                type="checkbox"
                                name="explain"
                                value="true"
                                id="explain_checkbox"
                        >
                        <span>Show keywords</span>
                    </label>
                    <button
                            type="submit"
                            class="primary-button"
                            aria-label="Analyze email"
                    >
                        <span class="send-icon">âž¤</span>
                    </button>
                </div>
            </form>
        </div>
    </section>
    
    {% if show_result %}
    <section id="screen-result" class="result-section">
        <div class="result-container">
            <div class="result-status {% if is_spam %}result-status-spam{% else %}result-status-notspam{% endif %}">
                {% if is_spam %}
                    SPAM
                {% else %}
                    Not Spam
                {% endif %}
            </div>
            
            <div class="result-card">
                <div class="result-text">
                    {% if is_spam %}
                        This email has been classified as spam. It may contain suspicious patterns, 
                        promotional content, or characteristics commonly found in unsolicited messages.
                    {% else %}
                        This email appears to be legitimate. It doesn't contain typical spam indicators 
                        and seems to be a genuine message.
                    {% endif %}
                </div>
            </div>

            {% if keywords %}
            <div class="result-card">
                <div class="result-text">
                    <strong>Top keywords:</strong>
                    <ul>
                        {% for word, score in keywords %}
                        <li>{{ word }} ({{ "%.3f"|format(score) }})</li>
                        {% endfor %}
                    </ul>
                </div>
            </div>
            {% endif %}

            <div class="result-card result-prompt-card">
                <div class="result-text result-prompt-text">
                    <strong>Your email:</strong><br>
                    {{ user_text }}
                </div>
                <form method="GET" action="{{ url_for('spam.show_form') }}">
                    <button
                            type="submit"
                            class="next-button"
                    >
                        Check Another Email
                    </button>
                </form>
            </div>
        </div>
    </section>
    {% endif %}
</main>

<script>
function toggleTheme() {
    const body = document.body;
    const html = document.documentElement;
    
    if (body.classList.contains('theme-light') || html.classList.contains('theme-light')) {
        body.classList.remove('theme-light');
        body.classList.add('theme-dark');
        html.classList.remove('theme-light');
        html.classList.add('theme-dark');
        localStorage.setItem('theme', 'dark');
    } else {
        body.classList.remove('theme-dark');
        body.classList.add('theme-light');
        html.classList.remove('theme-dark');
        html.classList.add('theme-light');
        localStorage.setItem('theme', 'light');
    }
}

function toggleFont() {
    const body = document.body;
    const html = document.documentElement;
    
    if (body.classList.contains('font-small') || html.classList.contains('font-small')) {
        body.classList.remove('font-small');
        body.classList.add('font-medium');
        html.classList.remove('font-small');
        html.classList.add('font-medium');
        localStorage.setItem('fontSize', 'medium');
    } else if (body.classList.contains('font-medium') || html.classList.contains('font-medium')) {
        body.classList.remove('font-medium');
        body.classList.add('font-large');
        html.classList.remove('font-medium');
        html.classList.add('font-large');
        localStorage.setItem('fontSize', 'large');
    } else {
        body.classList.remove('font-large');
        body.classList.add('font-small');
        html.classList.remove('font-large');
        html.classList.add('font-small');
        localStorage.setItem('fontSize', 'small');
    }
}

window.addEventListener('DOMContentLoaded', function() {
    const savedTheme = localStorage.getItem('theme');
    const savedFont = localStorage.getItem('fontSize');
    
    if (savedTheme === 'dark') {
        document.body.classList.remove('theme-light');
        document.body.classList.add('theme-dark');
    } else {
        document.body.classList.remove('theme-dark');
        document.body.classList.add('theme-light');
    }
    
    if (savedFont) {
        document.body.classList.remove('font-small', 'font-medium', 'font-large');
        document.body.classList.add('font-' + savedFont);
    } else {
        document.body.classList.add('font-medium');
    }
});
</script>
</body>
</html>